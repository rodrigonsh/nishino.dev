import{g as r,r as i,o,e as m,a as n,u as g,w as v,F as M,X as q,b as l,f as H,h as N,i as P,d,t as _,j as R,c as y}from"./app-2c521372.js";import{_ as U}from"./AuthenticatedLayout-6d6c2e5c.js";import{I as F}from"./rules-bcd4dbe1.js";import"./sweetalert2.all-c32728c7.js";import{u as X}from"./store-c7613b76.js";const z={key:2,class:"harvey"},D=l("strong",null,[d("Atendimento: "),l("br")],-1),I={key:3,class:"user"},O=l("br",null,null,-1),$=["value"],W={__name:"Atendimento",props:{canLogin:Boolean,canRegister:Boolean,laravelToken:String},setup(V){const s=X(),j=function(a){return{message:{pt:"Mensagem",en:"Message",es:"Mensaje"}}[a][s.lang]},u=r(),c=r(""),f=r([]),b=r(),h=r(!1),x=r("snackbar!");let p=new XMLHttpRequest;p.onload=function(){f.value=JSON.parse(p.responseText),b.value=f.value[0].value},p.open("get",route("cliente.getProjetos")),p.send();const T=()=>{s.setChatStatus(!0),s.setUserMessage("atendimento-message",c.value),setTimeout(function(){u.value.scrollTop=u.value.scrollHeight});let a=new FormData(document.querySelector(".chat-send"));a.append("message",c.value),a.append("lang",s.lang);let e=new XMLHttpRequest;e.onload=function(){s.setAssistantMessage("atendimento-message",e.responseText),s.setChatStatus(!1),setTimeout(function(){u.value.scrollTop=u.value.scrollHeight})},e.open("POST",route("atendimento-message")),e.send(a),c.value=""},A=function(a){R.setClientChatSubject(a).then(e=>{s.setAssistantMessage("atendimento-message",e.data),s.setChatStatus(!1)})};return(a,e)=>{const C=i("v-select"),k=i("v-container"),S=i("v-avatar"),w=i("v-text-field"),B=i("v-btn"),L=i("v-snackbar");return o(),m(M,null,[n(g(q),{title:"Atendimento"}),n(U,{title:"Atendimento"},{default:v(()=>[n(k,{class:"w-100 pa-7 bg-dialog",id:"atendimentoChatProjectSelect"},{default:v(()=>[n(C,{"prepend-inner-icon":"mdi-folder-cog",label:"Selecione o Projeto",items:f.value,modelValue:b.value,"onUpdate:modelValue":[e[0]||(e[0]=t=>b.value=t),A]},null,8,["items","modelValue"])]),_:1}),n(k,{class:"chat"},{default:v(()=>[l("div",{class:N({chatMessages:!0,loading:g(s).chatLoading}),ref_key:"messages",ref:u},[(o(!0),m(M,null,H(g(s).clientMessages,t=>(o(),m("div",{class:"chatMessage",key:t.key},[t.user=="Atendimento"?(o(),y(S,{key:0,class:"mr-2 mt-3",image:"/img/atendimento-profile.jpg"})):(o(),y(S,{key:1,class:"mr-2 mt-3",image:"/img/user-profile.jpg"})),t.user=="Atendimento"?(o(),m("p",z,[D,d(" "+_(t.message),1)])):(o(),m("p",I,[l("strong",null,[d(_(t.user)+": ",1),O]),d(" "+_(t.message),1)]))]))),128))],2),l("form",{onSubmit:e[2]||(e[2]=P(t=>T(),["prevent"])),class:"chat-send"},[l("input",{type:"hidden",name:"_token",value:V.laravelToken},null,8,$),n(w,{variant:"underlined","prepend-inner-icon":"mdi-message",modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),label:j("message"),rules:[g(F).required],required:""},null,8,["modelValue","label","rules"]),n(B,{type:"submit",icon:"mdi-send",size:"large",variant:"plain"})],32)]),_:1}),n(L,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=t=>h.value=t),timeout:"2000"},{default:v(()=>[d(_(x.value),1)]),_:1},8,["modelValue"])]),_:1})],64)}}};export{W as default};
